<h1 id="dichotomous-choice-modeling">Dichotomous Choice Modeling</h1>
<h2 id="introduction">Introduction</h2>
<p>In the 1980s, researchers Ben-Akiva and Lerman interviewed commuters
in Boston about their transportation choices. Their specific research
question was simple but important: <em>Does the difference in commute
time between car and bus affect people‚Äôs mode choice?</em></p>
<p>To answer this, they surveyed huundreds of commuters, collecting data
on: - Their actual commute times by car and by bus - Their actual
commuting choice (0 = drove to work, 1 = took the bus)</p>
<p>Here‚Äôs a table showing these data for 21 of the commuters surveyed.
While the authors collected data on a whole range of variables, we will
just ignore them for the purpose of this chapter. In our model, we will
not include any controls to keep things simple. In real life, of course,
a person‚Äôs commuting choice will depend of many, many factors.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">ID</th>
<th style="text-align: center;">Commute Time (minutes)</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">Choice</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Auto</td>
<td style="text-align: center;">Bus</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">:‚Äì:</td>
<td style="text-align: center;">:‚Äî-:</td>
<td style="text-align: center;">:‚Äî:</td>
<td style="text-align: center;">:‚Äî‚Äî:</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">51.0</td>
<td style="text-align: center;">85.0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">95.0</td>
<td style="text-align: center;">43.5</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">18.5</td>
<td style="text-align: center;">84.0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">62.0</td>
<td style="text-align: center;">4.4</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">41.5</td>
<td style="text-align: center;">24.5</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">2.0</td>
<td style="text-align: center;">91.2</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">82.0</td>
<td style="text-align: center;">38.0</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">8</td>
<td style="text-align: center;">27.6</td>
<td style="text-align: center;">79.7</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">9</td>
<td style="text-align: center;">99.1</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">51.4</td>
<td style="text-align: center;">83.8</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">11</td>
<td style="text-align: center;">8.6</td>
<td style="text-align: center;">1.6</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">12</td>
<td style="text-align: center;">22.5</td>
<td style="text-align: center;">74.1</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">13</td>
<td style="text-align: center;">51.8</td>
<td style="text-align: center;">20.2</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">14</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">86.9</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">15</td>
<td style="text-align: center;">62.2</td>
<td style="text-align: center;">90.1</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">16</td>
<td style="text-align: center;">89.9</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">17</td>
<td style="text-align: center;">41.6</td>
<td style="text-align: center;">91.5</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">18</td>
<td style="text-align: center;">56.2</td>
<td style="text-align: center;">31.6</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">19</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">28.5</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">20</td>
<td style="text-align: center;">95.1</td>
<td style="text-align: center;">22.5</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">21</td>
<td style="text-align: center;">81.0</td>
<td style="text-align: center;">19.2</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>Some of the values in the table are very odd. And no, I
double-checked, I transcribed them here correctly.</p>
<p>The variable choice is coded as either 0 or 1, where 0 is the code
for commuters who drove to work and 1 for those that took the bus. We
can now sort these by this variable and calculate the difference in
commute times. We will further assume that a person‚Äôs commuting choice
depends <em>only</em> on the difference in commute time between the two
options they have. Here‚Äôs the modified table.</p>
<table>
<thead>
<tr>
<th rowspan="2" style="text-align: center;">
ID
</th>
<th colspan="2" style="text-align: center;">
Commute Time (minutes)
</th>
<th rowspan="2" style="text-align: center;">
Choice
</th>
</tr>
<tr>
<th style="text-align: center;">
Auto
</th>
<th style="text-align: center;">
Bus
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">
1
</td>
<td style="text-align: center;">
51.0
</td>
<td style="text-align: center;">
85.0
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
2
</td>
<td style="text-align: center;">
95.0
</td>
<td style="text-align: center;">
43.5
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
3
</td>
<td style="text-align: center;">
18.5
</td>
<td style="text-align: center;">
84.0
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
4
</td>
<td style="text-align: center;">
62.0
</td>
<td style="text-align: center;">
4.4
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
5
</td>
<td style="text-align: center;">
41.5
</td>
<td style="text-align: center;">
24.5
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
6
</td>
<td style="text-align: center;">
2.0
</td>
<td style="text-align: center;">
91.2
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
7
</td>
<td style="text-align: center;">
82.0
</td>
<td style="text-align: center;">
38.0
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
8
</td>
<td style="text-align: center;">
27.6
</td>
<td style="text-align: center;">
79.7
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
9
</td>
<td style="text-align: center;">
99.1
</td>
<td style="text-align: center;">
2.2
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
10
</td>
<td style="text-align: center;">
51.4
</td>
<td style="text-align: center;">
83.8
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
11
</td>
<td style="text-align: center;">
8.6
</td>
<td style="text-align: center;">
1.6
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
12
</td>
<td style="text-align: center;">
22.5
</td>
<td style="text-align: center;">
74.1
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
13
</td>
<td style="text-align: center;">
51.8
</td>
<td style="text-align: center;">
20.2
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
14
</td>
<td style="text-align: center;">
4.1
</td>
<td style="text-align: center;">
86.9
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
15
</td>
<td style="text-align: center;">
62.2
</td>
<td style="text-align: center;">
90.1
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
16
</td>
<td style="text-align: center;">
89.9
</td>
<td style="text-align: center;">
2.2
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
17
</td>
<td style="text-align: center;">
41.6
</td>
<td style="text-align: center;">
91.5
</td>
<td style="text-align: center;">
0
</td>
</tr>
<tr>
<td style="text-align: center;">
18
</td>
<td style="text-align: center;">
56.2
</td>
<td style="text-align: center;">
31.6
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
19
</td>
<td style="text-align: center;">
4.1
</td>
<td style="text-align: center;">
28.5
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
20
</td>
<td style="text-align: center;">
95.1
</td>
<td style="text-align: center;">
22.5
</td>
<td style="text-align: center;">
1
</td>
</tr>
<tr>
<td style="text-align: center;">
21
</td>
<td style="text-align: center;">
81.0
</td>
<td style="text-align: center;">
19.2
</td>
<td style="text-align: center;">
1
</td>
</tr>
</tbody>
</table>
<p>We can now make a scatter plot of the last two columns, with
difference in commute times on the X-axis and the commuters‚Äô choices on
the Y-axis.</p>
<figure id="fig-commute-scatter">
<img src="/assets/dichotomous-choice/figures/commute_scatter.png" style="width:85.0%"
data-fig-align="center"
alt="Scatter plot showing the relationship between commute time differences and mode choice. When driving takes longer than the bus (positive differences), commuters tend to choose the bus. When the bus takes longer (negative differences), commuters tend to drive." />
<figcaption aria-hidden="true">Scatter plot showing the relationship
between commute time differences and mode choice. When driving takes
longer than the bus (positive differences), commuters tend to choose the
bus. When the bus takes longer (negative differences), commuters tend to
drive.</figcaption>
</figure>
<p>Our task is to model this relationship: to understand how the
difference in commute time influences the probability that someone will
choose transit. To do this, I want to bring you on a brief historical
journey.</p>
<h2 id="a-problem-of-transportation-planning">A Problem of
Transportation Planning</h2>
<p>In the mid-1960s, traffic congestion in the Bay Area had reached a
critical juncture. The California Highway Commission faced a fundamental
decision: should they continue investing in freeway expansion, or could
a new mass transit system offer a better path forward? They proposed an
ambitious solution‚Äîa network of buses and rail that would connect the
region, fundamentally reshaping how people commuted.</p>
<p>But there was a problem. Before committing billions in public
resources, the Commission needed to answer a deceptively simple
question: <em>How many people would actually use this system?</em></p>
<p>In 1969, with the first BART station under construction, the
Commission faced a pilot phase evaluation. They needed to estimate
ridership‚Äînot based on hunches or optimistic projections, but on actual
data about people‚Äôs choices. So they conducted an extensive survey of
Bay Area residents, asking a seemingly straightforward question:
<em>Would you take the bus instead of driving?</em></p>
<p>Yes or no.</p>
<p>This binary question‚Äîa dichotomous choice‚Äîwould unlock something far
more significant than transit planning. It would lead to the discovery
of a new statistical framework that would transform how economists,
marketers, and policymakers understand decision-making itself.</p>
<h2 id="the-birth-of-a-framework-dan-mcfaddens-insight">The Birth of a
Framework: Dan McFadden‚Äôs Insight</h2>
<p>The Commission‚Äôs first instinct was to use standard
regression‚Äîtreating the yes/no responses as if they were continuous
measurements. Using this linear probability model, they estimated that
about 15% of Bay Area residents would use the new transit system.</p>
<p>But then they hired a young economist named Dan McFadden, recently
arrived at UC Berkeley. McFadden looked at the problem differently. He
recognized something fundamental: when people make discrete choices‚Äîyes
or no, use transit or drive, buy or don‚Äôt buy‚Äîthe standard tools of
regression analysis were fundamentally mismatched to the problem.</p>
<p>McFadden developed a new approach using what he called <em>latent
variable models</em>. The insight was elegant: behind every observed
choice lies an unobserved psychological disposition. When someone
decides whether to take the bus, they‚Äôre processing information about
commute time, cost, convenience, and comfort‚Äîall of which feed into a
latent evaluation of the option. When that latent evaluation exceeds
some threshold, they choose to use transit.</p>
<p>Using this framework, McFadden predicted that only about 6.3% of
residents would use BART. His colleagues dismissed this as too
pessimistic. Yet when BART opened and ridership was measured, it came in
at 6.2%‚Äîremarkably close to McFadden‚Äôs prediction.</p>
<p>This work on discrete choice modeling was so significant that in
2000‚Äîmore than three decades later‚ÄîMcFadden was awarded the Nobel Prize
in Economics. The Nobel citation recognized his contribution: <em>‚Äúhe
showed how to statistically handle fundamental aspects of microdata,
namely data on the most important decisions we make in life: the choice
of education, occupation, place of residence, marital status, number of
children, so called discrete choices.‚Äù</em></p>
<p>Today, the methods McFadden pioneered are used everywhere: predicting
consumer behavior, understanding labor market decisions, analyzing
election outcomes, and evaluating policy interventions.</p>
<h2 id="back-to-boston-understanding-commuting-choices">Back to Boston:
Understanding Commuting Choices</h2>
<p>The data we plotted above tell a clear visual story. When the
difference in commute time favors driving (negative values), people
drive. When the difference favors the bus (positive values), people take
transit. Yet there‚Äôs variation even within these patterns‚Äîsome people
take the bus despite longer commute times, and others drive even when
the bus would be faster.</p>
<p>So let‚Äôs get on with our task. We will build a model that answers the
following question: If the commute time by transit could be reduce, by
how much would the probability that someone will choose transit
increase?</p>
<h2 id="the-binary-probability-function">The Binary Probability
Function</h2>
<p>To begin, let‚Äôs establish some basic foundations. When people make
dichotomous (two-choice) decisions, we can describe the outcome using
the <strong>Bernoulli distribution</strong>.</p>
<section id="the-bernoulli-distribution" class="callout-important">
<h2>The Bernoulli Distribution</h2>
<p>For a dichotomous outcome <span class="math inline">Y</span> that
takes the value 1 with probability <span class="math inline">p</span>
and the value 0 with probability <span class="math inline">(1-p)</span>,
the probability function is:</p>
<p><span class="math display">f(y) = p^y(1-p)^{1-y}</span></p>
<p>The expected value of <span class="math inline">Y</span> is
simply:</p>
<p><span class="math display">E(Y) = (1-p)  imes 0 + p  imes 1 =
p</span></p>
</section>
<p>In our commuting example, <span class="math inline">Y = 1</span>
represents choosing transit and <span class="math inline">Y = 0</span>
represents choosing a car. The probability <span
class="math inline">p</span> represents the probability that an
individual will choose transit, given their specific circumstances.</p>
<p>Following standard econometric practice, we decompose the observed
outcome into a deterministic part (what we can predict) and a stochastic
part (random variation):</p>
<p><span class="math display">Y_i = p_i + psilon_i</span></p>
<p>where <span class="math inline">p_i</span> is the predicted
probability for individual <span class="math inline">i</span> and <span
class="math inline">psilon_i</span> is the error term.</p>
<p>The key question becomes: <strong>How does the difference in commute
times relate to <span class="math inline">p</span>?</strong></p>
<h2 id="the-linear-probability-model-a-first-attempt">The Linear
Probability Model: A First Attempt</h2>
<p>The most straightforward approach is the <strong>Linear Probability
Model (LPM)</strong>, which assumes a linear relationship between the
commute time difference and the probability of choosing transit:</p>
<p>$$p_i = eta_0 + eta_1</p>
